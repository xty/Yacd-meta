import{r as E,R as h,i as f,j as n,s as G,c as ne,b as c,k as ae,l as V,n as U,o as re,h as H,d as q,q as le,g as J,t as oe,u as se,v as ie,w as _,x as ce,y as de,z as ue,A as pe,D as he,C as fe,E as S,F as ve,B as y,G as me,H as ge,J as be}from"./index-105ee7af.js";import{r as ye}from"./logs-ec214c52.js";import{S as w}from"./Select-2d836143.js";import{R as we}from"./rotate-cw-b86718e4.js";function P(){return P=Object.assign||function(e){for(var l=1;l<arguments.length;l++){var r=arguments[l];for(var a in r)Object.prototype.hasOwnProperty.call(r,a)&&(e[a]=r[a])}return e},P.apply(this,arguments)}function ke(e,l){if(e==null)return{};var r=Ce(e,l),a,t;if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(t=0;t<o.length;t++)a=o[t],!(l.indexOf(a)>=0)&&Object.prototype.propertyIsEnumerable.call(e,a)&&(r[a]=e[a])}return r}function Ce(e,l){if(e==null)return{};var r={},a=Object.keys(e),t,o;for(o=0;o<a.length;o++)t=a[o],!(l.indexOf(t)>=0)&&(r[t]=e[t]);return r}var L=E.forwardRef(function(e,l){var r=e.color,a=r===void 0?"currentColor":r,t=e.size,o=t===void 0?24:t,p=ke(e,["color","size"]);return h.createElement("svg",P({ref:l,xmlns:"http://www.w3.org/2000/svg",width:o,height:o,viewBox:"0 0 24 24",fill:"none",stroke:a,strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},p),h.createElement("polyline",{points:"8 17 12 21 16 17"}),h.createElement("line",{x1:"12",y1:"12",x2:"12",y2:"21"}),h.createElement("path",{d:"M20.88 18.09A5 5 0 0 0 18 9h-1.26A8 8 0 1 0 3 16.29"}))});L.propTypes={color:f.string,size:f.oneOfType([f.string,f.number])};L.displayName="DownloadCloud";const Oe=L;function j(){return j=Object.assign||function(e){for(var l=1;l<arguments.length;l++){var r=arguments[l];for(var a in r)Object.prototype.hasOwnProperty.call(r,a)&&(e[a]=r[a])}return e},j.apply(this,arguments)}function _e(e,l){if(e==null)return{};var r=Se(e,l),a,t;if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(t=0;t<o.length;t++)a=o[t],!(l.indexOf(a)>=0)&&Object.prototype.propertyIsEnumerable.call(e,a)&&(r[a]=e[a])}return r}function Se(e,l){if(e==null)return{};var r={},a=Object.keys(e),t,o;for(o=0;o<a.length;o++)t=a[o],!(l.indexOf(t)>=0)&&(r[t]=e[t]);return r}var $=E.forwardRef(function(e,l){var r=e.color,a=r===void 0?"currentColor":r,t=e.size,o=t===void 0?24:t,p=_e(e,["color","size"]);return h.createElement("svg",j({ref:l,xmlns:"http://www.w3.org/2000/svg",width:o,height:o,viewBox:"0 0 24 24",fill:"none",stroke:a,strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},p),h.createElement("path",{d:"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4"}),h.createElement("polyline",{points:"16 17 21 12 16 7"}),h.createElement("line",{x1:"21",y1:"12",x2:"9",y2:"12"}))});$.propTypes={color:f.string,size:f.oneOfType([f.string,f.number])};$.displayName="LogOut";const Ne=$;function I(){return I=Object.assign||function(e){for(var l=1;l<arguments.length;l++){var r=arguments[l];for(var a in r)Object.prototype.hasOwnProperty.call(r,a)&&(e[a]=r[a])}return e},I.apply(this,arguments)}function xe(e,l){if(e==null)return{};var r=Pe(e,l),a,t;if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(t=0;t<o.length;t++)a=o[t],!(l.indexOf(a)>=0)&&Object.prototype.propertyIsEnumerable.call(e,a)&&(r[a]=e[a])}return r}function Pe(e,l){if(e==null)return{};var r={},a=Object.keys(e),t,o;for(o=0;o<a.length;o++)t=a[o],!(l.indexOf(t)>=0)&&(r[t]=e[t]);return r}var z=E.forwardRef(function(e,l){var r=e.color,a=r===void 0?"currentColor":r,t=e.size,o=t===void 0?24:t,p=xe(e,["color","size"]);return h.createElement("svg",I({ref:l,xmlns:"http://www.w3.org/2000/svg",width:o,height:o,viewBox:"0 0 24 24",fill:"none",stroke:a,strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},p),h.createElement("polyline",{points:"3 6 5 6 21 6"}),h.createElement("path",{d:"M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6m3 0V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2"}),h.createElement("line",{x1:"10",y1:"11",x2:"10",y2:"17"}),h.createElement("line",{x1:"14",y1:"11",x2:"14",y2:"17"}))});z.propTypes={color:f.string,size:f.oneOfType([f.string,f.number])};z.displayName="Trash2";const je=z,{useState:Ie,useRef:Ee,useEffect:Le,useCallback:$e}=h;function N(e){return n("input",{className:G.input,...e})}function ze({value:e,...l}){const[r,a]=Ie(e),t=Ee(e);Le(()=>{t.current!==e&&a(e),t.current=e},[e]);const o=$e(p=>a(p.target.value),[a]);return n("input",{className:G.input,value:r,onChange:o,...l})}const Te="_root_1vck5_4",Re="_section_1vck5_5",De="_wrapSwitch_1vck5_30",Fe="_sep_1vck5_36",Me="_label_1vck5_49",i={root:Te,section:Re,wrapSwitch:De,sep:Fe,label:Me},We="_fieldset_olb4q_1",Ae="_input_olb4q_10",Be="_cnt_olb4q_10",x={fieldset:We,input:Ae,cnt:Be};function Ve({OptionComponent:e,optionPropsList:l,selectedIndex:r,onChange:a}){const t=ne("visually-hidden",x.input),o=p=>{a(p.target.value)};return n("fieldset",{className:x.fieldset,children:l.map((p,d)=>c("label",{children:[n("input",{type:"radio",checked:r===d,name:"selection",value:d,"aria-labelledby":"traffic chart type "+d,onChange:o,className:t}),n("div",{className:x.cnt,children:n(e,{...p})})]},d))})}const{useMemo:Ue}=H,Ge={plugins:{legend:{display:!1}},scales:{x:{display:!1,type:"category"},y:{display:!1,type:"linear"}}},Q=[23e3,35e3,46e3,33e3,9e4,68e3,23e3,45e3],He=[184e3,183e3,196e3,182e3,19e4,186e3,182e3,189e3],qe=Q;function Je({id:e}){const l=ae.read(),r=Ue(()=>({labels:qe,datasets:[{...V,...U[e].up,data:Q},{...V,...U[e].down,data:He}]}),[e]),a="chart-"+e;return re(l.Chart,a,r,null,Ge),n("div",{style:{width:80,padding:5},children:n("canvas",{id:a})})}const{useEffect:K,useState:Qe,useCallback:m,useRef:Ke}=H,Xe=[{id:0},{id:1},{id:2},{id:3}],Ye=[["debug","Debug"],["info","Info"],["warning","Warning"],["error","Error"],["silent","Silent"]],Ze=[{key:"port",label:"Http Port"},{key:"socks-port",label:"Socks5 Port"},{key:"mixed-port",label:"Mixed Port"},{key:"redir-port",label:"Redir Port"},{key:"mitm-port",label:"MITM Port"}],et=[["zh","中文"],["en","English"]],tt=[["direct","Direct"],["rule","Rule"],["script","Script"],["global","Global"]],nt=[["gvisor","gVisor"],["system","System"],["lwip","LWIP"]],at=e=>({configs:le(e),apiConfig:J(e)}),rt=e=>({selectedChartStyleIndex:ge(e),latencyTestUrl:be(e),apiConfig:J(e)}),lt=q(rt)(st),pt=q(at)(ot);function ot({dispatch:e,configs:l,apiConfig:r}){return K(()=>{e(oe(r))},[e,r]),n(lt,{configs:l})}function st({dispatch:e,configs:l,selectedChartStyleIndex:r,latencyTestUrl:a,apiConfig:t}){var M,W,A,B;const{t:o,i18n:p}=se(),[d,k]=Qe(l),T=Ke(l);K(()=>{T.current!==l&&k(l),T.current=l},[l]);const X=m(()=>{e(ie("apiConfig"))},[e]),C=m((s,u)=>{k({...d,[s]:u})},[d]),R=m((s,u)=>{const v={...d.tun,[s]:u};k({...d,tun:{...v}})},[d]),g=m(({name:s,value:u})=>{switch(s){case"mode":case"log-level":case"allow-lan":case"sniffing":C(s,u),e(_(t,{[s]:u})),s==="log-level"&&ye({...t,logLevel:u});break;case"mitm-port":case"redir-port":case"socks-port":case"mixed-port":case"port":if(u!==""){const v=parseInt(u,10);if(v<0||v>65535)return}C(s,u);break;case"enable":case"stack":R(s,u),e(_(t,{tun:{[s]:u}}));break;default:return}},[t,e,C,R]),{selectChartStyleIndex:Y,updateAppConfig:D}=ce(),b=m(s=>{const{name:u,value:v}=s.target;switch(u){case"port":case"socks-port":case"mixed-port":case"redir-port":case"mitm-port":{const O=parseInt(v,10);if(O<0||O>65535)return;e(_(t,{[u]:O}));break}case"latencyTestUrl":{D(u,v);break}case"device name":case"interface name":break;default:throw new Error(`unknown input name ${u}`)}},[t,e,D]),Z=m(()=>{e(de(t))},[t,e]),ee=m(()=>{e(ue(t))},[t,e]),te=m(()=>{e(pe(t))},[t,e]),{data:F}=he(["/version",t],()=>me("/version",t));return c("div",{children:[n(fe,{title:o("Config")}),c("div",{className:i.root,children:[Ze.map(s=>d[s.key]!==void 0?c("div",{children:[n("div",{className:i.label,children:s.label}),n(N,{name:s.key,value:d[s.key],onChange:({target:{name:u,value:v}})=>g({name:u,value:v}),onBlur:b})]},s.key):null),c("div",{children:[n("div",{className:i.label,children:"Mode"}),n(w,{options:tt,selected:d.mode.toLowerCase(),onChange:s=>g({name:"mode",value:s.target.value})})]}),c("div",{children:[n("div",{className:i.label,children:"Log Level"}),n(w,{options:Ye,selected:d["log-level"].toLowerCase(),onChange:s=>g({name:"log-level",value:s.target.value})})]}),c("div",{children:[n("div",{className:i.label,children:o("allow_lan")}),n("div",{className:i.wrapSwitch,children:n(S,{name:"allow-lan",checked:d["allow-lan"],onChange:s=>g({name:"allow-lan",value:s})})})]}),F.meta&&c("div",{children:[n("div",{className:i.label,children:o("tls_sniffing")}),n("div",{className:i.wrapSwitch,children:n(S,{name:"sniffing",checked:d.sniffing,onChange:s=>g({name:"sniffing",value:s})})})]})]}),n("div",{className:i.sep,children:n("div",{})}),F.meta&&c(ve,{children:[c("div",{className:i.section,children:[c("div",{children:[n("div",{className:i.label,children:o("enable_tun_device")}),n("div",{className:i.wrapSwitch,children:n(S,{checked:(M=d.tun)==null?void 0:M.enable,onChange:s=>g({name:"enable",value:s})})})]}),c("div",{children:[n("div",{className:i.label,children:"TUN IP Stack"}),n(w,{options:nt,selected:(A=(W=d.tun)==null?void 0:W.stack)==null?void 0:A.toLowerCase(),onChange:s=>g({name:"stack",value:s.target.value})})]}),c("div",{children:[n("div",{className:i.label,children:"Device Name"}),n(N,{name:"device name",value:(B=d.tun)==null?void 0:B.device,onChange:b})]}),c("div",{children:[n("div",{className:i.label,children:"Interface Name"}),n(N,{name:"interface name",value:d["interface-name"]||"",onChange:b})]})]}),n("div",{className:i.sep,children:n("div",{})}),c("div",{className:i.section,children:[c("div",{children:[n("div",{className:i.label,children:"Reload"}),n(y,{start:n(we,{size:16}),label:o("reload_config_file"),onClick:Z})]}),c("div",{children:[n("div",{className:i.label,children:"GEO Databases"}),n(y,{start:n(Oe,{size:16}),label:o("update_geo_databases_file"),onClick:ee})]}),c("div",{children:[n("div",{className:i.label,children:"FakeIP"}),n(y,{start:n(je,{size:16}),label:o("flush_fake_ip_pool"),onClick:te})]})]}),n("div",{className:i.sep,children:n("div",{})})]}),c("div",{className:i.section,children:[c("div",{children:[n("div",{className:i.label,children:o("latency_test_url")}),n(ze,{name:"latencyTestUrl",type:"text",value:a,onBlur:b})]}),c("div",{children:[n("div",{className:i.label,children:o("lang")}),n("div",{children:n(w,{options:et,selected:p.language,onChange:s=>p.changeLanguage(s.target.value)})})]}),c("div",{children:[n("div",{className:i.label,children:o("chart_style")}),n(Ve,{OptionComponent:Je,optionPropsList:Xe,selectedIndex:r,onChange:Y})]}),c("div",{children:[n("div",{className:i.label,children:"Action"}),n(y,{start:n(Ne,{size:16}),label:"Switch backend",onClick:X})]})]})]})}export{pt as default};
